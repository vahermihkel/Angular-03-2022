/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input, Output, EventEmitter, forwardRef, TemplateRef } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { DraggableItemService } from './draggable-item.service';
/* tslint:disable */
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/common';

const _c0 = [3, "ngClass", "ngStyle", "dragover", "dragenter", "drop", "mouseleave"];
const _c1 = [3, "ngClass", "ngStyle", "dragover", "dragenter", 4, "ngIf"];
const _c2 = ["draggable", "true", "aria-dropeffect", "move", 3, "ngClass", "ngStyle", "dragstart", "dragend", "dragover", "dragenter", 4, "ngFor", "ngForOf"];
const _c3 = ["defItemTemplate", ""];
const _c4 = [3, "ngClass", "ngStyle", "dragover", "dragenter"];
function SortableComponent_div_1_Template(rf, ctx) { if (rf & 1) {
    const _r1403 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", _c4);
    ɵngcc0.ɵɵlistener("dragover", function SortableComponent_div_1_Template_div_dragover_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r1403); const ctx_r1402 = ɵngcc0.ɵɵnextContext(); return ctx_r1402.onItemDragover($event, 0); });
    ɵngcc0.ɵɵlistener("dragenter", function SortableComponent_div_1_Template_div_dragenter_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r1403); const ctx_r1404 = ɵngcc0.ɵɵnextContext(); return ctx_r1404.cancelEvent($event); });
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1398 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngClass", ctx_r1398.placeholderClass)("ngStyle", ctx_r1398.placeholderStyle);
    ɵngcc0.ɵɵselect(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r1398.placeholderItem);
} }
const _c5 = ["draggable", "true", "aria-dropeffect", "move", 3, "ngClass", "ngStyle", "dragstart", "dragend", "dragover", "dragenter"];
const _c6 = [3, "ngTemplateOutlet", "ngTemplateOutletContext"];
function SortableComponent_div_2_ng_template_1_Template(rf, ctx) { }
const _c7 = function (a0, a1) { return [a0, a1]; };
const _c8 = function (a0, a1) { return { item: a0, index: a1 }; };
function SortableComponent_div_2_Template(rf, ctx) { if (rf & 1) {
    const _r1409 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", _c5);
    ɵngcc0.ɵɵlistener("dragstart", function SortableComponent_div_2_Template_div_dragstart_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r1409); const item_r1405 = ctx.$implicit; const i_r1406 = ctx.index; const ctx_r1408 = ɵngcc0.ɵɵnextContext(); return ctx_r1408.onItemDragstart($event, item_r1405, i_r1406); });
    ɵngcc0.ɵɵlistener("dragend", function SortableComponent_div_2_Template_div_dragend_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r1409); const ctx_r1410 = ɵngcc0.ɵɵnextContext(); return ctx_r1410.resetActiveItem($event); });
    ɵngcc0.ɵɵlistener("dragover", function SortableComponent_div_2_Template_div_dragover_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r1409); const i_r1406 = ctx.index; const ctx_r1411 = ɵngcc0.ɵɵnextContext(); return ctx_r1411.onItemDragover($event, i_r1406); });
    ɵngcc0.ɵɵlistener("dragenter", function SortableComponent_div_2_Template_div_dragenter_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r1409); const ctx_r1412 = ɵngcc0.ɵɵnextContext(); return ctx_r1412.cancelEvent($event); });
    ɵngcc0.ɵɵtemplate(1, SortableComponent_div_2_ng_template_1_Template, 0, 0, "ng-template", _c6);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const item_r1405 = ctx.$implicit;
    const i_r1406 = ctx.index;
    const ctx_r1399 = ɵngcc0.ɵɵnextContext();
    const _r1400 = ɵngcc0.ɵɵreference(4);
    ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpureFunction2(5, _c7, ctx_r1399.itemClass, i_r1406 === ctx_r1399.activeItem ? ctx_r1399.itemActiveClass : ""))("ngStyle", ctx_r1399.getItemStyle(i_r1406 === ctx_r1399.activeItem));
    ɵngcc0.ɵɵattribute("aria-grabbed", i_r1406 === ctx_r1399.activeItem);
    ɵngcc0.ɵɵselect(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r1399.itemTemplate || _r1400)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction2(8, _c8, item_r1405, i_r1406));
} }
function SortableComponent_ng_template_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtext(0);
} if (rf & 2) {
    const item_r1413 = ctx.item;
    ɵngcc0.ɵɵtextInterpolate(item_r1413.value);
} }
var SortableComponent = /** @class */ (function () {
    function SortableComponent(transfer) {
        var _this = this;
        /**
         * class name for items wrapper
         */
        this.wrapperClass = '';
        /**
         * style object for items wrapper
         */
        this.wrapperStyle = {};
        /**
         * class name for item
         */
        this.itemClass = '';
        /**
         * style object for item
         */
        this.itemStyle = {};
        /**
         * class name for active item
         */
        this.itemActiveClass = '';
        /**
         * style object for active item
         */
        this.itemActiveStyle = {};
        /**
         * class name for placeholder
         */
        this.placeholderClass = '';
        /**
         * style object for placeholder
         */
        this.placeholderStyle = {};
        /**
         * placeholder item which will be shown if collection is empty
         */
        this.placeholderItem = '';
        /**
         * fired on array change (reordering, insert, remove), same as <code>ngModelChange</code>.
         *  Returns new items collection as a payload.
         */
        /* tslint:disable-next-line: no-any */
        this.onChange = new EventEmitter();
        this.showPlaceholder = false;
        this.activeItem = -1;
        /* tslint:disable-next-line: no-any */
        this.onTouched = Function.prototype;
        /* tslint:disable-next-line: no-any */
        this.onChanged = Function.prototype;
        this.transfer = transfer;
        this.currentZoneIndex = SortableComponent.globalZoneIndex++;
        this.transfer
            .onCaptureItem()
            .subscribe((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return _this.onDrop(item); }));
    }
    Object.defineProperty(SortableComponent.prototype, "items", {
        get: /**
         * @return {?}
         */
        function () {
            return this._items;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._items = value;
            /** @type {?} */
            var out = this.items.map((/**
             * @param {?} x
             * @return {?}
             */
            function (x) { return x.initData; }));
            this.onChanged(out);
            this.onChange.emit(out);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} event
     * @param {?} item
     * @param {?} i
     * @return {?}
     */
    SortableComponent.prototype.onItemDragstart = /**
     * @param {?} event
     * @param {?} item
     * @param {?} i
     * @return {?}
     */
    function (event, item, i) {
        this.initDragstartEvent(event);
        this.onTouched();
        this.transfer.dragStart({
            event: event,
            item: item,
            i: i,
            initialIndex: i,
            lastZoneIndex: this.currentZoneIndex,
            overZoneIndex: this.currentZoneIndex
        });
    };
    /**
     * @param {?} event
     * @param {?} i
     * @return {?}
     */
    SortableComponent.prototype.onItemDragover = /**
     * @param {?} event
     * @param {?} i
     * @return {?}
     */
    function (event, i) {
        if (!this.transfer.getItem()) {
            return;
        }
        event.preventDefault();
        /** @type {?} */
        var dragItem = this.transfer.captureItem(this.currentZoneIndex, this.items.length);
        /* tslint:disable-next-line: no-any */
        /** @type {?} */
        var newArray = [];
        if (!this.items.length) {
            newArray = [dragItem.item];
        }
        else if (dragItem.i > i) {
            newArray = tslib_1.__spread(this.items.slice(0, i), [
                dragItem.item
            ], this.items.slice(i, dragItem.i), this.items.slice(dragItem.i + 1));
        }
        else {
            // this.draggedItem.i < i
            newArray = tslib_1.__spread(this.items.slice(0, dragItem.i), this.items.slice(dragItem.i + 1, i + 1), [
                dragItem.item
            ], this.items.slice(i + 1));
        }
        this.items = newArray;
        dragItem.i = i;
        this.activeItem = i;
        this.updatePlaceholderState();
    };
    /**
     * @param {?} event
     * @return {?}
     */
    SortableComponent.prototype.cancelEvent = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (!this.transfer.getItem() || !event) {
            return;
        }
        event.preventDefault();
    };
    /**
     * @param {?} item
     * @return {?}
     */
    SortableComponent.prototype.onDrop = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        if (item &&
            item.overZoneIndex !== this.currentZoneIndex &&
            item.lastZoneIndex === this.currentZoneIndex) {
            this.items = this.items.filter((/**
             * @param {?} x
             * @param {?} i
             * @return {?}
             */
            function (x, i) { return i !== item.i; }));
            this.updatePlaceholderState();
        }
        this.resetActiveItem(undefined);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    SortableComponent.prototype.resetActiveItem = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.cancelEvent(event);
        this.activeItem = -1;
    };
    /**
     * @param {?} callback
     * @return {?}
     */
    SortableComponent.prototype.registerOnChange = /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
        this.onChanged = callback;
    };
    /**
     * @param {?} callback
     * @return {?}
     */
    SortableComponent.prototype.registerOnTouched = /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
        this.onTouched = callback;
    };
    /* tslint:disable-next-line: no-any */
    /* tslint:disable-next-line: no-any */
    /**
     * @param {?} value
     * @return {?}
     */
    SortableComponent.prototype.writeValue = /* tslint:disable-next-line: no-any */
    /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        var _this = this;
        if (value) {
            /* tslint:disable-next-line: no-any */
            this.items = value.map((/**
             * @param {?} x
             * @param {?} i
             * @return {?}
             */
            function (x, i) { return ({
                id: i,
                initData: x,
                value: _this.fieldName ? x[_this.fieldName] : x
            }); }));
        }
        else {
            this.items = [];
        }
        this.updatePlaceholderState();
    };
    /**
     * @return {?}
     */
    SortableComponent.prototype.updatePlaceholderState = /**
     * @return {?}
     */
    function () {
        this.showPlaceholder = !this._items.length;
    };
    /**
     * @param {?} isActive
     * @return {?}
     */
    SortableComponent.prototype.getItemStyle = /**
     * @param {?} isActive
     * @return {?}
     */
    function (isActive) {
        return isActive
            ? Object.assign({}, this.itemStyle, this.itemActiveStyle)
            : this.itemStyle;
    };
    // tslint:disable-next-line
    // tslint:disable-next-line
    /**
     * @private
     * @param {?} event
     * @return {?}
     */
    SortableComponent.prototype.initDragstartEvent = 
    // tslint:disable-next-line
    /**
     * @private
     * @param {?} event
     * @return {?}
     */
    function (event) {
        // it is necessary for mozilla
        // data type should be 'Text' instead of 'text/plain' to keep compatibility
        // with IE
        event.dataTransfer.setData('Text', 'placeholder');
    };
    SortableComponent.globalZoneIndex = 0;
    /** @nocollapse */
    SortableComponent.ctorParameters = function () { return [
        { type: DraggableItemService }
    ]; };
    SortableComponent.propDecorators = {
        fieldName: [{ type: Input }],
        wrapperClass: [{ type: Input }],
        wrapperStyle: [{ type: Input }],
        itemClass: [{ type: Input }],
        itemStyle: [{ type: Input }],
        itemActiveClass: [{ type: Input }],
        itemActiveStyle: [{ type: Input }],
        placeholderClass: [{ type: Input }],
        placeholderStyle: [{ type: Input }],
        placeholderItem: [{ type: Input }],
        itemTemplate: [{ type: Input }],
        onChange: [{ type: Output }]
    };
SortableComponent.ngComponentDef = ɵngcc0.ɵɵdefineComponent({ type: SortableComponent, selectors: [["bs-sortable"]], factory: function SortableComponent_Factory(t) { return new (t || SortableComponent)(ɵngcc0.ɵɵdirectiveInject(DraggableItemService)); }, inputs: { wrapperClass: "wrapperClass", wrapperStyle: "wrapperStyle", itemClass: "itemClass", itemStyle: "itemStyle", itemActiveClass: "itemActiveClass", itemActiveStyle: "itemActiveStyle", placeholderClass: "placeholderClass", placeholderStyle: "placeholderStyle", placeholderItem: "placeholderItem", fieldName: "fieldName", itemTemplate: "itemTemplate" }, outputs: { onChange: "onChange" }, exportAs: ["bs-sortable"], features: [ɵngcc0.ɵɵProvidersFeature([
            {
                provide: NG_VALUE_ACCESSOR,
                useExisting: forwardRef(( /**
                 * @return {?}
                 */function () { return SortableComponent; })),
                multi: true
            }
        ])], consts: 5, vars: 5, template: function SortableComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", _c0);
        ɵngcc0.ɵɵlistener("dragover", function SortableComponent_Template_div_dragover_0_listener($event) { return ctx.cancelEvent($event); });
        ɵngcc0.ɵɵlistener("dragenter", function SortableComponent_Template_div_dragenter_0_listener($event) { return ctx.cancelEvent($event); });
        ɵngcc0.ɵɵlistener("drop", function SortableComponent_Template_div_drop_0_listener($event) { return ctx.resetActiveItem($event); });
        ɵngcc0.ɵɵlistener("mouseleave", function SortableComponent_Template_div_mouseleave_0_listener($event) { return ctx.resetActiveItem($event); });
        ɵngcc0.ɵɵtemplate(1, SortableComponent_div_1_Template, 2, 3, "div", _c1);
        ɵngcc0.ɵɵtemplate(2, SortableComponent_div_2_Template, 2, 11, "div", _c2);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(3, SortableComponent_ng_template_3_Template, 1, 1, "ng-template", null, _c3, ɵngcc0.ɵɵtemplateRefExtractor);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngClass", ctx.wrapperClass)("ngStyle", ctx.wrapperStyle)("ngStyle", ctx.wrapperStyle);
        ɵngcc0.ɵɵselect(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.showPlaceholder);
        ɵngcc0.ɵɵselect(2);
        ɵngcc0.ɵɵproperty("ngForOf", ctx.items);
    } }, directives: [ɵngcc1.NgClass, ɵngcc1.NgStyle, ɵngcc1.NgIf, ɵngcc1.NgForOf, ɵngcc1.NgTemplateOutlet], encapsulation: 2 });
/*@__PURE__*/ ɵngcc0.ɵsetClassMetadata(SortableComponent, [{
        type: Component,
        args: [{
                selector: 'bs-sortable',
                exportAs: 'bs-sortable',
                template: "\n<div\n    [ngClass]=\"wrapperClass\"\n    [ngStyle]=\"wrapperStyle\"\n    [ngStyle]=\"wrapperStyle\"\n    (dragover)=\"cancelEvent($event)\"\n    (dragenter)=\"cancelEvent($event)\"\n    (drop)=\"resetActiveItem($event)\"\n    (mouseleave)=\"resetActiveItem($event)\">\n  <div\n        *ngIf=\"showPlaceholder\"\n        [ngClass]=\"placeholderClass\"\n        [ngStyle]=\"placeholderStyle\"\n        (dragover)=\"onItemDragover($event, 0)\"\n        (dragenter)=\"cancelEvent($event)\"\n    >{{placeholderItem}}</div>\n    <div\n        *ngFor=\"let item of items; let i=index;\"\n        [ngClass]=\"[ itemClass, i === activeItem ? itemActiveClass : '' ]\"\n        [ngStyle]=\"getItemStyle(i === activeItem)\"\n        draggable=\"true\"\n        (dragstart)=\"onItemDragstart($event, item, i)\"\n        (dragend)=\"resetActiveItem($event)\"\n        (dragover)=\"onItemDragover($event, i)\"\n        (dragenter)=\"cancelEvent($event)\"\n        aria-dropeffect=\"move\"\n        [attr.aria-grabbed]=\"i === activeItem\"\n    ><ng-template [ngTemplateOutlet]=\"itemTemplate || defItemTemplate\"\n  [ngTemplateOutletContext]=\"{item:item, index: i}\"></ng-template></div>\n</div>\n\n<ng-template #defItemTemplate let-item=\"item\">{{item.value}}</ng-template>  \n",
                providers: [
                    {
                        provide: NG_VALUE_ACCESSOR,
                        useExisting: forwardRef(( /**
                         * @return {?}
                         */function () { return SortableComponent; })),
                        multi: true
                    }
                ]
            }]
    }], function () { return [{ type: DraggableItemService }]; }, { wrapperClass: [{
            type: Input
        }], wrapperStyle: [{
            type: Input
        }], itemClass: [{
            type: Input
        }], itemStyle: [{
            type: Input
        }], itemActiveClass: [{
            type: Input
        }], itemActiveStyle: [{
            type: Input
        }], placeholderClass: [{
            type: Input
        }], placeholderStyle: [{
            type: Input
        }], placeholderItem: [{
            type: Input
        }], onChange: [{
            type: Output
        }], showPlaceholder: [], activeItem: [], onTouched: [], onChanged: [], transfer: [], currentZoneIndex: [], items: [], items: [], onItemDragstart: [], onItemDragover: [], cancelEvent: [], onDrop: [], resetActiveItem: [], registerOnChange: [], registerOnTouched: [], writeValue: [], updatePlaceholderState: [], getItemStyle: [], initDragstartEvent: [], fieldName: [{
            type: Input
        }], itemTemplate: [{
            type: Input
        }] });
    return SortableComponent;
}());
export { SortableComponent };
if (false) {
    /**
     * @type {?}
     * @private
     */
    SortableComponent.globalZoneIndex;
    /**
     * field name if input array consists of objects
     * @type {?}
     */
    SortableComponent.prototype.fieldName;
    /**
     * class name for items wrapper
     * @type {?}
     */
    SortableComponent.prototype.wrapperClass;
    /**
     * style object for items wrapper
     * @type {?}
     */
    SortableComponent.prototype.wrapperStyle;
    /**
     * class name for item
     * @type {?}
     */
    SortableComponent.prototype.itemClass;
    /**
     * style object for item
     * @type {?}
     */
    SortableComponent.prototype.itemStyle;
    /**
     * class name for active item
     * @type {?}
     */
    SortableComponent.prototype.itemActiveClass;
    /**
     * style object for active item
     * @type {?}
     */
    SortableComponent.prototype.itemActiveStyle;
    /**
     * class name for placeholder
     * @type {?}
     */
    SortableComponent.prototype.placeholderClass;
    /**
     * style object for placeholder
     * @type {?}
     */
    SortableComponent.prototype.placeholderStyle;
    /**
     * placeholder item which will be shown if collection is empty
     * @type {?}
     */
    SortableComponent.prototype.placeholderItem;
    /**
     * used to specify a custom item template. Template variables: item and index;
     * @type {?}
     */
    SortableComponent.prototype.itemTemplate;
    /**
     * fired on array change (reordering, insert, remove), same as <code>ngModelChange</code>.
     *  Returns new items collection as a payload.
     * @type {?}
     */
    SortableComponent.prototype.onChange;
    /** @type {?} */
    SortableComponent.prototype.showPlaceholder;
    /** @type {?} */
    SortableComponent.prototype.activeItem;
    /** @type {?} */
    SortableComponent.prototype.onTouched;
    /** @type {?} */
    SortableComponent.prototype.onChanged;
    /**
     * @type {?}
     * @private
     */
    SortableComponent.prototype.transfer;
    /**
     * @type {?}
     * @private
     */
    SortableComponent.prototype.currentZoneIndex;
    /**
     * @type {?}
     * @private
     */
    SortableComponent.prototype._items;
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImM6L1VzZXJzL3ZhaGVybWloL2tvb2xpdHVzZWQvQW5ndWxhci0wMy0yMDIyL2FuZ3VsYXItYmFrZXJ5c2hvcC9ub2RlX21vZHVsZXMvbmd4LWJvb3RzdHJhcC9zb3J0YWJsZS9lc201L3NvcnRhYmxlLmNvbXBvbmVudC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBU0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7MENBb1MwQyxBQWlCcEM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztjQWtCQSIsImZpbGUiOiJzb3J0YWJsZS5jb21wb25lbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBmaWxlb3ZlcnZpZXcgYWRkZWQgYnkgdHNpY2tsZVxuICogQHN1cHByZXNzIHtjaGVja1R5cGVzLGV4dHJhUmVxdWlyZSxtaXNzaW5nT3ZlcnJpZGUsbWlzc2luZ1JldHVybix1bnVzZWRQcml2YXRlTWVtYmVycyx1c2VsZXNzQ29kZX0gY2hlY2tlZCBieSB0c2NcbiAqL1xuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBmb3J3YXJkUmVmLCBUZW1wbGF0ZVJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgTkdfVkFMVUVfQUNDRVNTT1IgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBEcmFnZ2FibGVJdGVtU2VydmljZSB9IGZyb20gJy4vZHJhZ2dhYmxlLWl0ZW0uc2VydmljZSc7XG4vKiB0c2xpbnQ6ZGlzYWJsZSAqL1xudmFyIFNvcnRhYmxlQ29tcG9uZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNvcnRhYmxlQ29tcG9uZW50KHRyYW5zZmVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjbGFzcyBuYW1lIGZvciBpdGVtcyB3cmFwcGVyXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLndyYXBwZXJDbGFzcyA9ICcnO1xuICAgICAgICAvKipcbiAgICAgICAgICogc3R5bGUgb2JqZWN0IGZvciBpdGVtcyB3cmFwcGVyXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLndyYXBwZXJTdHlsZSA9IHt9O1xuICAgICAgICAvKipcbiAgICAgICAgICogY2xhc3MgbmFtZSBmb3IgaXRlbVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pdGVtQ2xhc3MgPSAnJztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHN0eWxlIG9iamVjdCBmb3IgaXRlbVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pdGVtU3R5bGUgPSB7fTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNsYXNzIG5hbWUgZm9yIGFjdGl2ZSBpdGVtXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLml0ZW1BY3RpdmVDbGFzcyA9ICcnO1xuICAgICAgICAvKipcbiAgICAgICAgICogc3R5bGUgb2JqZWN0IGZvciBhY3RpdmUgaXRlbVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pdGVtQWN0aXZlU3R5bGUgPSB7fTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNsYXNzIG5hbWUgZm9yIHBsYWNlaG9sZGVyXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnBsYWNlaG9sZGVyQ2xhc3MgPSAnJztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHN0eWxlIG9iamVjdCBmb3IgcGxhY2Vob2xkZXJcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucGxhY2Vob2xkZXJTdHlsZSA9IHt9O1xuICAgICAgICAvKipcbiAgICAgICAgICogcGxhY2Vob2xkZXIgaXRlbSB3aGljaCB3aWxsIGJlIHNob3duIGlmIGNvbGxlY3Rpb24gaXMgZW1wdHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucGxhY2Vob2xkZXJJdGVtID0gJyc7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBmaXJlZCBvbiBhcnJheSBjaGFuZ2UgKHJlb3JkZXJpbmcsIGluc2VydCwgcmVtb3ZlKSwgc2FtZSBhcyA8Y29kZT5uZ01vZGVsQ2hhbmdlPC9jb2RlPi5cbiAgICAgICAgICogIFJldHVybnMgbmV3IGl0ZW1zIGNvbGxlY3Rpb24gYXMgYSBwYXlsb2FkLlxuICAgICAgICAgKi9cbiAgICAgICAgLyogdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBuby1hbnkgKi9cbiAgICAgICAgdGhpcy5vbkNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5zaG93UGxhY2Vob2xkZXIgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5hY3RpdmVJdGVtID0gLTE7XG4gICAgICAgIC8qIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogbm8tYW55ICovXG4gICAgICAgIHRoaXMub25Ub3VjaGVkID0gRnVuY3Rpb24ucHJvdG90eXBlO1xuICAgICAgICAvKiB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IG5vLWFueSAqL1xuICAgICAgICB0aGlzLm9uQ2hhbmdlZCA9IEZ1bmN0aW9uLnByb3RvdHlwZTtcbiAgICAgICAgdGhpcy50cmFuc2ZlciA9IHRyYW5zZmVyO1xuICAgICAgICB0aGlzLmN1cnJlbnRab25lSW5kZXggPSBTb3J0YWJsZUNvbXBvbmVudC5nbG9iYWxab25lSW5kZXgrKztcbiAgICAgICAgdGhpcy50cmFuc2ZlclxuICAgICAgICAgICAgLm9uQ2FwdHVyZUl0ZW0oKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgoLyoqXG4gICAgICAgICAqIEBwYXJhbSB7P30gaXRlbVxuICAgICAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIF90aGlzLm9uRHJvcChpdGVtKTsgfSkpO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU29ydGFibGVDb21wb25lbnQucHJvdG90eXBlLCBcIml0ZW1zXCIsIHtcbiAgICAgICAgZ2V0OiAvKipcbiAgICAgICAgICogQHJldHVybiB7P31cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pdGVtcztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiAvKipcbiAgICAgICAgICogQHBhcmFtIHs/fSB2YWx1ZVxuICAgICAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9pdGVtcyA9IHZhbHVlO1xuICAgICAgICAgICAgLyoqIEB0eXBlIHs/fSAqL1xuICAgICAgICAgICAgdmFyIG91dCA9IHRoaXMuaXRlbXMubWFwKCgvKipcbiAgICAgICAgICAgICAqIEBwYXJhbSB7P30geFxuICAgICAgICAgICAgICogQHJldHVybiB7P31cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHguaW5pdERhdGE7IH0pKTtcbiAgICAgICAgICAgIHRoaXMub25DaGFuZ2VkKG91dCk7XG4gICAgICAgICAgICB0aGlzLm9uQ2hhbmdlLmVtaXQob3V0KTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/fSBldmVudFxuICAgICAqIEBwYXJhbSB7P30gaXRlbVxuICAgICAqIEBwYXJhbSB7P30gaVxuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgU29ydGFibGVDb21wb25lbnQucHJvdG90eXBlLm9uSXRlbURyYWdzdGFydCA9IC8qKlxuICAgICAqIEBwYXJhbSB7P30gZXZlbnRcbiAgICAgKiBAcGFyYW0gez99IGl0ZW1cbiAgICAgKiBAcGFyYW0gez99IGlcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIChldmVudCwgaXRlbSwgaSkge1xuICAgICAgICB0aGlzLmluaXREcmFnc3RhcnRFdmVudChldmVudCk7XG4gICAgICAgIHRoaXMub25Ub3VjaGVkKCk7XG4gICAgICAgIHRoaXMudHJhbnNmZXIuZHJhZ1N0YXJ0KHtcbiAgICAgICAgICAgIGV2ZW50OiBldmVudCxcbiAgICAgICAgICAgIGl0ZW06IGl0ZW0sXG4gICAgICAgICAgICBpOiBpLFxuICAgICAgICAgICAgaW5pdGlhbEluZGV4OiBpLFxuICAgICAgICAgICAgbGFzdFpvbmVJbmRleDogdGhpcy5jdXJyZW50Wm9uZUluZGV4LFxuICAgICAgICAgICAgb3ZlclpvbmVJbmRleDogdGhpcy5jdXJyZW50Wm9uZUluZGV4XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/fSBldmVudFxuICAgICAqIEBwYXJhbSB7P30gaVxuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgU29ydGFibGVDb21wb25lbnQucHJvdG90eXBlLm9uSXRlbURyYWdvdmVyID0gLyoqXG4gICAgICogQHBhcmFtIHs/fSBldmVudFxuICAgICAqIEBwYXJhbSB7P30gaVxuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgZnVuY3Rpb24gKGV2ZW50LCBpKSB7XG4gICAgICAgIGlmICghdGhpcy50cmFuc2Zlci5nZXRJdGVtKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAvKiogQHR5cGUgez99ICovXG4gICAgICAgIHZhciBkcmFnSXRlbSA9IHRoaXMudHJhbnNmZXIuY2FwdHVyZUl0ZW0odGhpcy5jdXJyZW50Wm9uZUluZGV4LCB0aGlzLml0ZW1zLmxlbmd0aCk7XG4gICAgICAgIC8qIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogbm8tYW55ICovXG4gICAgICAgIC8qKiBAdHlwZSB7P30gKi9cbiAgICAgICAgdmFyIG5ld0FycmF5ID0gW107XG4gICAgICAgIGlmICghdGhpcy5pdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIG5ld0FycmF5ID0gW2RyYWdJdGVtLml0ZW1dO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRyYWdJdGVtLmkgPiBpKSB7XG4gICAgICAgICAgICBuZXdBcnJheSA9IHRzbGliXzEuX19zcHJlYWQodGhpcy5pdGVtcy5zbGljZSgwLCBpKSwgW1xuICAgICAgICAgICAgICAgIGRyYWdJdGVtLml0ZW1cbiAgICAgICAgICAgIF0sIHRoaXMuaXRlbXMuc2xpY2UoaSwgZHJhZ0l0ZW0uaSksIHRoaXMuaXRlbXMuc2xpY2UoZHJhZ0l0ZW0uaSArIDEpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIHRoaXMuZHJhZ2dlZEl0ZW0uaSA8IGlcbiAgICAgICAgICAgIG5ld0FycmF5ID0gdHNsaWJfMS5fX3NwcmVhZCh0aGlzLml0ZW1zLnNsaWNlKDAsIGRyYWdJdGVtLmkpLCB0aGlzLml0ZW1zLnNsaWNlKGRyYWdJdGVtLmkgKyAxLCBpICsgMSksIFtcbiAgICAgICAgICAgICAgICBkcmFnSXRlbS5pdGVtXG4gICAgICAgICAgICBdLCB0aGlzLml0ZW1zLnNsaWNlKGkgKyAxKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pdGVtcyA9IG5ld0FycmF5O1xuICAgICAgICBkcmFnSXRlbS5pID0gaTtcbiAgICAgICAgdGhpcy5hY3RpdmVJdGVtID0gaTtcbiAgICAgICAgdGhpcy51cGRhdGVQbGFjZWhvbGRlclN0YXRlKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gez99IGV2ZW50XG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUuY2FuY2VsRXZlbnQgPSAvKipcbiAgICAgKiBAcGFyYW0gez99IGV2ZW50XG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLnRyYW5zZmVyLmdldEl0ZW0oKSB8fCAhZXZlbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/fSBpdGVtXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUub25Ecm9wID0gLyoqXG4gICAgICogQHBhcmFtIHs/fSBpdGVtXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICBpZiAoaXRlbSAmJlxuICAgICAgICAgICAgaXRlbS5vdmVyWm9uZUluZGV4ICE9PSB0aGlzLmN1cnJlbnRab25lSW5kZXggJiZcbiAgICAgICAgICAgIGl0ZW0ubGFzdFpvbmVJbmRleCA9PT0gdGhpcy5jdXJyZW50Wm9uZUluZGV4KSB7XG4gICAgICAgICAgICB0aGlzLml0ZW1zID0gdGhpcy5pdGVtcy5maWx0ZXIoKC8qKlxuICAgICAgICAgICAgICogQHBhcmFtIHs/fSB4XG4gICAgICAgICAgICAgKiBAcGFyYW0gez99IGlcbiAgICAgICAgICAgICAqIEByZXR1cm4gez99XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uICh4LCBpKSB7IHJldHVybiBpICE9PSBpdGVtLmk7IH0pKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUGxhY2Vob2xkZXJTdGF0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVzZXRBY3RpdmVJdGVtKHVuZGVmaW5lZCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gez99IGV2ZW50XG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUucmVzZXRBY3RpdmVJdGVtID0gLyoqXG4gICAgICogQHBhcmFtIHs/fSBldmVudFxuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuY2FuY2VsRXZlbnQoZXZlbnQpO1xuICAgICAgICB0aGlzLmFjdGl2ZUl0ZW0gPSAtMTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7P30gY2FsbGJhY2tcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIFNvcnRhYmxlQ29tcG9uZW50LnByb3RvdHlwZS5yZWdpc3Rlck9uQ2hhbmdlID0gLyoqXG4gICAgICogQHBhcmFtIHs/fSBjYWxsYmFja1xuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMub25DaGFuZ2VkID0gY2FsbGJhY2s7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gez99IGNhbGxiYWNrXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUucmVnaXN0ZXJPblRvdWNoZWQgPSAvKipcbiAgICAgKiBAcGFyYW0gez99IGNhbGxiYWNrXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5vblRvdWNoZWQgPSBjYWxsYmFjaztcbiAgICB9O1xuICAgIC8qIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogbm8tYW55ICovXG4gICAgLyogdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBuby1hbnkgKi9cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gez99IHZhbHVlXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUud3JpdGVWYWx1ZSA9IC8qIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogbm8tYW55ICovXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/fSB2YWx1ZVxuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgLyogdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBuby1hbnkgKi9cbiAgICAgICAgICAgIHRoaXMuaXRlbXMgPSB2YWx1ZS5tYXAoKC8qKlxuICAgICAgICAgICAgICogQHBhcmFtIHs/fSB4XG4gICAgICAgICAgICAgKiBAcGFyYW0gez99IGlcbiAgICAgICAgICAgICAqIEByZXR1cm4gez99XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uICh4LCBpKSB7IHJldHVybiAoe1xuICAgICAgICAgICAgICAgIGlkOiBpLFxuICAgICAgICAgICAgICAgIGluaXREYXRhOiB4LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBfdGhpcy5maWVsZE5hbWUgPyB4W190aGlzLmZpZWxkTmFtZV0gOiB4XG4gICAgICAgICAgICB9KTsgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlUGxhY2Vob2xkZXJTdGF0ZSgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUudXBkYXRlUGxhY2Vob2xkZXJTdGF0ZSA9IC8qKlxuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNob3dQbGFjZWhvbGRlciA9ICF0aGlzLl9pdGVtcy5sZW5ndGg7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gez99IGlzQWN0aXZlXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUuZ2V0SXRlbVN0eWxlID0gLyoqXG4gICAgICogQHBhcmFtIHs/fSBpc0FjdGl2ZVxuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgZnVuY3Rpb24gKGlzQWN0aXZlKSB7XG4gICAgICAgIHJldHVybiBpc0FjdGl2ZVxuICAgICAgICAgICAgPyBPYmplY3QuYXNzaWduKHt9LCB0aGlzLml0ZW1TdHlsZSwgdGhpcy5pdGVtQWN0aXZlU3R5bGUpXG4gICAgICAgICAgICA6IHRoaXMuaXRlbVN0eWxlO1xuICAgIH07XG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lXG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0gez99IGV2ZW50XG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUuaW5pdERyYWdzdGFydEV2ZW50ID0gXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lXG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0gez99IGV2ZW50XG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgLy8gaXQgaXMgbmVjZXNzYXJ5IGZvciBtb3ppbGxhXG4gICAgICAgIC8vIGRhdGEgdHlwZSBzaG91bGQgYmUgJ1RleHQnIGluc3RlYWQgb2YgJ3RleHQvcGxhaW4nIHRvIGtlZXAgY29tcGF0aWJpbGl0eVxuICAgICAgICAvLyB3aXRoIElFXG4gICAgICAgIGV2ZW50LmRhdGFUcmFuc2Zlci5zZXREYXRhKCdUZXh0JywgJ3BsYWNlaG9sZGVyJyk7XG4gICAgfTtcbiAgICBTb3J0YWJsZUNvbXBvbmVudC5nbG9iYWxab25lSW5kZXggPSAwO1xuICAgIFNvcnRhYmxlQ29tcG9uZW50LmRlY29yYXRvcnMgPSBbXG4gICAgICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ2JzLXNvcnRhYmxlJyxcbiAgICAgICAgICAgICAgICAgICAgZXhwb3J0QXM6ICdicy1zb3J0YWJsZScsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBcIlxcbjxkaXZcXG4gICAgW25nQ2xhc3NdPVxcXCJ3cmFwcGVyQ2xhc3NcXFwiXFxuICAgIFtuZ1N0eWxlXT1cXFwid3JhcHBlclN0eWxlXFxcIlxcbiAgICBbbmdTdHlsZV09XFxcIndyYXBwZXJTdHlsZVxcXCJcXG4gICAgKGRyYWdvdmVyKT1cXFwiY2FuY2VsRXZlbnQoJGV2ZW50KVxcXCJcXG4gICAgKGRyYWdlbnRlcik9XFxcImNhbmNlbEV2ZW50KCRldmVudClcXFwiXFxuICAgIChkcm9wKT1cXFwicmVzZXRBY3RpdmVJdGVtKCRldmVudClcXFwiXFxuICAgIChtb3VzZWxlYXZlKT1cXFwicmVzZXRBY3RpdmVJdGVtKCRldmVudClcXFwiPlxcbiAgPGRpdlxcbiAgICAgICAgKm5nSWY9XFxcInNob3dQbGFjZWhvbGRlclxcXCJcXG4gICAgICAgIFtuZ0NsYXNzXT1cXFwicGxhY2Vob2xkZXJDbGFzc1xcXCJcXG4gICAgICAgIFtuZ1N0eWxlXT1cXFwicGxhY2Vob2xkZXJTdHlsZVxcXCJcXG4gICAgICAgIChkcmFnb3Zlcik9XFxcIm9uSXRlbURyYWdvdmVyKCRldmVudCwgMClcXFwiXFxuICAgICAgICAoZHJhZ2VudGVyKT1cXFwiY2FuY2VsRXZlbnQoJGV2ZW50KVxcXCJcXG4gICAgPnt7cGxhY2Vob2xkZXJJdGVtfX08L2Rpdj5cXG4gICAgPGRpdlxcbiAgICAgICAgKm5nRm9yPVxcXCJsZXQgaXRlbSBvZiBpdGVtczsgbGV0IGk9aW5kZXg7XFxcIlxcbiAgICAgICAgW25nQ2xhc3NdPVxcXCJbIGl0ZW1DbGFzcywgaSA9PT0gYWN0aXZlSXRlbSA/IGl0ZW1BY3RpdmVDbGFzcyA6ICcnIF1cXFwiXFxuICAgICAgICBbbmdTdHlsZV09XFxcImdldEl0ZW1TdHlsZShpID09PSBhY3RpdmVJdGVtKVxcXCJcXG4gICAgICAgIGRyYWdnYWJsZT1cXFwidHJ1ZVxcXCJcXG4gICAgICAgIChkcmFnc3RhcnQpPVxcXCJvbkl0ZW1EcmFnc3RhcnQoJGV2ZW50LCBpdGVtLCBpKVxcXCJcXG4gICAgICAgIChkcmFnZW5kKT1cXFwicmVzZXRBY3RpdmVJdGVtKCRldmVudClcXFwiXFxuICAgICAgICAoZHJhZ292ZXIpPVxcXCJvbkl0ZW1EcmFnb3ZlcigkZXZlbnQsIGkpXFxcIlxcbiAgICAgICAgKGRyYWdlbnRlcik9XFxcImNhbmNlbEV2ZW50KCRldmVudClcXFwiXFxuICAgICAgICBhcmlhLWRyb3BlZmZlY3Q9XFxcIm1vdmVcXFwiXFxuICAgICAgICBbYXR0ci5hcmlhLWdyYWJiZWRdPVxcXCJpID09PSBhY3RpdmVJdGVtXFxcIlxcbiAgICA+PG5nLXRlbXBsYXRlIFtuZ1RlbXBsYXRlT3V0bGV0XT1cXFwiaXRlbVRlbXBsYXRlIHx8IGRlZkl0ZW1UZW1wbGF0ZVxcXCJcXG4gIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XFxcIntpdGVtOml0ZW0sIGluZGV4OiBpfVxcXCI+PC9uZy10ZW1wbGF0ZT48L2Rpdj5cXG48L2Rpdj5cXG5cXG48bmctdGVtcGxhdGUgI2RlZkl0ZW1UZW1wbGF0ZSBsZXQtaXRlbT1cXFwiaXRlbVxcXCI+e3tpdGVtLnZhbHVlfX08L25nLXRlbXBsYXRlPiAgXFxuXCIsXG4gICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsgcmV0dXJuIFNvcnRhYmxlQ29tcG9uZW50OyB9KSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXVsdGk6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH1dIH1cbiAgICBdO1xuICAgIC8qKiBAbm9jb2xsYXBzZSAqL1xuICAgIFNvcnRhYmxlQ29tcG9uZW50LmN0b3JQYXJhbWV0ZXJzID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gW1xuICAgICAgICB7IHR5cGU6IERyYWdnYWJsZUl0ZW1TZXJ2aWNlIH1cbiAgICBdOyB9O1xuICAgIFNvcnRhYmxlQ29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgICAgICBmaWVsZE5hbWU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgICAgICB3cmFwcGVyQ2xhc3M6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgICAgICB3cmFwcGVyU3R5bGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgICAgICBpdGVtQ2xhc3M6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgICAgICBpdGVtU3R5bGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgICAgICBpdGVtQWN0aXZlQ2xhc3M6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgICAgICBpdGVtQWN0aXZlU3R5bGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgICAgICBwbGFjZWhvbGRlckNsYXNzOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICAgICAgcGxhY2Vob2xkZXJTdHlsZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgICAgIHBsYWNlaG9sZGVySXRlbTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgICAgIGl0ZW1UZW1wbGF0ZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgICAgIG9uQ2hhbmdlOiBbeyB0eXBlOiBPdXRwdXQgfV1cbiAgICB9O1xuICAgIHJldHVybiBTb3J0YWJsZUNvbXBvbmVudDtcbn0oKSk7XG5leHBvcnQgeyBTb3J0YWJsZUNvbXBvbmVudCB9O1xuaWYgKGZhbHNlKSB7XG4gICAgLyoqXG4gICAgICogQHR5cGUgez99XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5nbG9iYWxab25lSW5kZXg7XG4gICAgLyoqXG4gICAgICogZmllbGQgbmFtZSBpZiBpbnB1dCBhcnJheSBjb25zaXN0cyBvZiBvYmplY3RzXG4gICAgICogQHR5cGUgez99XG4gICAgICovXG4gICAgU29ydGFibGVDb21wb25lbnQucHJvdG90eXBlLmZpZWxkTmFtZTtcbiAgICAvKipcbiAgICAgKiBjbGFzcyBuYW1lIGZvciBpdGVtcyB3cmFwcGVyXG4gICAgICogQHR5cGUgez99XG4gICAgICovXG4gICAgU29ydGFibGVDb21wb25lbnQucHJvdG90eXBlLndyYXBwZXJDbGFzcztcbiAgICAvKipcbiAgICAgKiBzdHlsZSBvYmplY3QgZm9yIGl0ZW1zIHdyYXBwZXJcbiAgICAgKiBAdHlwZSB7P31cbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUud3JhcHBlclN0eWxlO1xuICAgIC8qKlxuICAgICAqIGNsYXNzIG5hbWUgZm9yIGl0ZW1cbiAgICAgKiBAdHlwZSB7P31cbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUuaXRlbUNsYXNzO1xuICAgIC8qKlxuICAgICAqIHN0eWxlIG9iamVjdCBmb3IgaXRlbVxuICAgICAqIEB0eXBlIHs/fVxuICAgICAqL1xuICAgIFNvcnRhYmxlQ29tcG9uZW50LnByb3RvdHlwZS5pdGVtU3R5bGU7XG4gICAgLyoqXG4gICAgICogY2xhc3MgbmFtZSBmb3IgYWN0aXZlIGl0ZW1cbiAgICAgKiBAdHlwZSB7P31cbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUuaXRlbUFjdGl2ZUNsYXNzO1xuICAgIC8qKlxuICAgICAqIHN0eWxlIG9iamVjdCBmb3IgYWN0aXZlIGl0ZW1cbiAgICAgKiBAdHlwZSB7P31cbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUuaXRlbUFjdGl2ZVN0eWxlO1xuICAgIC8qKlxuICAgICAqIGNsYXNzIG5hbWUgZm9yIHBsYWNlaG9sZGVyXG4gICAgICogQHR5cGUgez99XG4gICAgICovXG4gICAgU29ydGFibGVDb21wb25lbnQucHJvdG90eXBlLnBsYWNlaG9sZGVyQ2xhc3M7XG4gICAgLyoqXG4gICAgICogc3R5bGUgb2JqZWN0IGZvciBwbGFjZWhvbGRlclxuICAgICAqIEB0eXBlIHs/fVxuICAgICAqL1xuICAgIFNvcnRhYmxlQ29tcG9uZW50LnByb3RvdHlwZS5wbGFjZWhvbGRlclN0eWxlO1xuICAgIC8qKlxuICAgICAqIHBsYWNlaG9sZGVyIGl0ZW0gd2hpY2ggd2lsbCBiZSBzaG93biBpZiBjb2xsZWN0aW9uIGlzIGVtcHR5XG4gICAgICogQHR5cGUgez99XG4gICAgICovXG4gICAgU29ydGFibGVDb21wb25lbnQucHJvdG90eXBlLnBsYWNlaG9sZGVySXRlbTtcbiAgICAvKipcbiAgICAgKiB1c2VkIHRvIHNwZWNpZnkgYSBjdXN0b20gaXRlbSB0ZW1wbGF0ZS4gVGVtcGxhdGUgdmFyaWFibGVzOiBpdGVtIGFuZCBpbmRleDtcbiAgICAgKiBAdHlwZSB7P31cbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUuaXRlbVRlbXBsYXRlO1xuICAgIC8qKlxuICAgICAqIGZpcmVkIG9uIGFycmF5IGNoYW5nZSAocmVvcmRlcmluZywgaW5zZXJ0LCByZW1vdmUpLCBzYW1lIGFzIDxjb2RlPm5nTW9kZWxDaGFuZ2U8L2NvZGU+LlxuICAgICAqICBSZXR1cm5zIG5ldyBpdGVtcyBjb2xsZWN0aW9uIGFzIGEgcGF5bG9hZC5cbiAgICAgKiBAdHlwZSB7P31cbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUub25DaGFuZ2U7XG4gICAgLyoqIEB0eXBlIHs/fSAqL1xuICAgIFNvcnRhYmxlQ29tcG9uZW50LnByb3RvdHlwZS5zaG93UGxhY2Vob2xkZXI7XG4gICAgLyoqIEB0eXBlIHs/fSAqL1xuICAgIFNvcnRhYmxlQ29tcG9uZW50LnByb3RvdHlwZS5hY3RpdmVJdGVtO1xuICAgIC8qKiBAdHlwZSB7P30gKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUub25Ub3VjaGVkO1xuICAgIC8qKiBAdHlwZSB7P30gKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUub25DaGFuZ2VkO1xuICAgIC8qKlxuICAgICAqIEB0eXBlIHs/fVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgU29ydGFibGVDb21wb25lbnQucHJvdG90eXBlLnRyYW5zZmVyO1xuICAgIC8qKlxuICAgICAqIEB0eXBlIHs/fVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgU29ydGFibGVDb21wb25lbnQucHJvdG90eXBlLmN1cnJlbnRab25lSW5kZXg7XG4gICAgLyoqXG4gICAgICogQHR5cGUgez99XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBTb3J0YWJsZUNvbXBvbmVudC5wcm90b3R5cGUuX2l0ZW1zO1xufVxuIl19